# <!-- Powered by BMADâ„¢ Core -->

# Story 7.10: Blog Foundation & First Post

## Status

Draft

## Story

**As a** potential user,
**I want** to read helpful content about surveys and data collection,
**so that** I can learn best practices and see the platform's expertise.

## Acceptance Criteria

1. Blog listing page created at /blog with public access
2. Blog post detail page at /blog/[slug]
3. Blog posts stored in database with BlogPost model: id, title, slug, excerpt, content, authorId, publishedAt, tags, createdAt
4. Admin page at /admin/blog for creating/editing posts (owner-only access)
5. Blog listing displays posts in grid: thumbnail, title, excerpt, date, author
6. Pagination for blog posts (10 per page)
7. First blog post: "5 Best Practices for Creating Effective Surveys" (i18n title/content)
8. Second blog post: "How to Increase Survey Response Rates" (i18n title/content)
9. Blog posts support Markdown formatting
10. Each post includes SEO metadata (title, description, OG tags)
11. Share buttons on blog posts (Twitter, LinkedIn, email)
12. Mobile-responsive blog layout
13. All blog UI labels and navigation fully translated

## Tasks / Subtasks

- [ ] Create BlogPost database model (AC: 3)
  - [ ] Add BlogPost model to Prisma schema
  - [ ] Fields: id, title, slug, excerpt, content (text), authorId, publishedAt, tags (array), createdAt, updatedAt
  - [ ] Add relation to User model (author)
  - [ ] Run Prisma migration

- [ ] Create blog listing page (AC: 1, 5, 6)
  - [ ] Create `app/blog/page.tsx`
  - [ ] Fetch published blog posts from database
  - [ ] Display posts in grid layout (thumbnail, title, excerpt, date, author)
  - [ ] Implement pagination (10 posts per page)
  - [ ] Use shadcn Pagination component

- [ ] Create blog post detail page (AC: 2, 9, 10, 11)
  - [ ] Create `app/blog/[slug]/page.tsx`
  - [ ] Fetch blog post by slug
  - [ ] Render content with Markdown support (react-markdown or next-mdx-remote)
  - [ ] Add SEO metadata (title, description, OG tags)
  - [ ] Add share buttons (Twitter, LinkedIn, email)

- [ ] Create blog admin page (AC: 4)
  - [ ] Create `app/admin/blog/page.tsx` (list all posts)
  - [ ] Create `app/admin/blog/new/page.tsx` (create new post)
  - [ ] Create `app/admin/blog/[id]/edit/page.tsx` (edit post)
  - [ ] Restrict access to owner role only
  - [ ] Build blog post form (title, slug, excerpt, content, tags, publishedAt)

- [ ] API endpoints for blog CRUD (AC: 4)
  - [ ] Create `app/api/blog/route.ts` (GET all, POST create)
  - [ ] Create `app/api/blog/[id]/route.ts` (GET, PATCH, DELETE)
  - [ ] Validate user is owner before allowing create/edit/delete

- [ ] Add Markdown rendering (AC: 9)
  - [ ] Install react-markdown or next-mdx-remote
  - [ ] Configure Markdown renderer with syntax highlighting
  - [ ] Style Markdown content

- [ ] Create first blog post (AC: 7)
  - [ ] Write "5 Best Practices for Creating Effective Surveys"
  - [ ] Create EN and FR versions
  - [ ] Add to database via admin or seed script

- [ ] Create second blog post (AC: 8)
  - [ ] Write "How to Increase Survey Response Rates"
  - [ ] Create EN and FR versions
  - [ ] Add to database via admin or seed script

- [ ] Add share buttons (AC: 11)
  - [ ] Create share button component
  - [ ] Twitter/X share button
  - [ ] LinkedIn share button
  - [ ] Email share button

- [ ] Add internationalization strings (AC: 13)
  - [ ] Add EN translations to `locales/en.json`: Blog.* keys
  - [ ] Add FR translations to `locales/fr.json`

- [ ] Testing and validation
  - [ ] Test blog listing page renders
  - [ ] Test blog detail page renders
  - [ ] Test pagination works
  - [ ] Test admin CRUD operations
  - [ ] Test Markdown rendering
  - [ ] Test share buttons
  - [ ] Test responsive layout
  - [ ] Test language switching (EN/FR)

## Dev Notes

### Epic Context

This is Story 7.10 in Epic 7: Marketing Website & Landing Pages. This story creates a blog foundation for content marketing and SEO benefits.

### Tech Stack

- **Framework**: Next.js 16 (App Router)
- **React**: 19
- **TypeScript**: 5.x
- **Database**: PostgreSQL with Prisma ORM
- **Styling**: Tailwind CSS 4.x
- **UI Components**: shadcn/ui (New York style)
- **Markdown**: react-markdown or next-mdx-remote
- **i18n**: next-intl

### Source Tree

- Blog listing: `app/blog/page.tsx`
- Blog detail: `app/blog/[slug]/page.tsx`
- Blog admin: `app/admin/blog/` (page.tsx, new/page.tsx, [id]/edit/page.tsx)
- API routes: `app/api/blog/route.ts`, `app/api/blog/[id]/route.ts`
- Prisma schema: `prisma/schema.prisma`
- Translations: `locales/en.json` and `locales/fr.json`

### Prisma Schema

```prisma
model BlogPost {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  excerpt     String
  content     String   @db.Text
  authorId    String
  author      User     @relation(fields: [authorId], references: [id], onDelete: Cascade)
  publishedAt DateTime?
  tags        String[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([authorId])
  @@index([slug])
  @@index([publishedAt])
}
```

Update User model:
```prisma
model User {
  // ... existing fields
  blogPosts BlogPost[]
}
```

### Markdown Rendering

Use react-markdown with syntax highlighting:

```typescript
import ReactMarkdown from 'react-markdown'
import { Prism as SyntaxHighlighter } from 'react-syntax-highlighter'
import { vscDarkPlus } from 'react-syntax-highlighter/dist/esm/styles/prism'

<ReactMarkdown
  components={{
    code({ node, inline, className, children, ...props }) {
      const match = /language-(\w+)/.exec(className || '')
      return !inline && match ? (
        <SyntaxHighlighter
          style={vscDarkPlus}
          language={match[1]}
          PreTag="div"
          {...props}
        >
          {String(children).replace(/\n$/, '')}
        </SyntaxHighlighter>
      ) : (
        <code className={className} {...props}>
          {children}
        </code>
      )
    }
  }}
>
  {content}
</ReactMarkdown>
```

### Sample Blog Post Content

**Post 1: "5 Best Practices for Creating Effective Surveys"**
- Keep it short (5-10 questions max)
- Use clear, unbiased language
- Offer a mix of question types
- Test before sending
- Provide context and purpose

**Post 2: "How to Increase Survey Response Rates"**
- Personalize your invitation
- Explain the survey's purpose
- Keep it short and focused
- Mobile optimization is key
- Offer incentives (if applicable)

### Share Button Implementation

Use Web Share API with fallbacks:

```typescript
const shareOnTwitter = () => {
  window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`)
}

const shareOnLinkedIn = () => {
  window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`)
}

const shareViaEmail = () => {
  window.location.href = `mailto:?subject=${encodeURIComponent(title)}&body=${encodeURIComponent(url)}`
}
```

### Integration Points

- Add link in navigation and footer (Story 7.11)
- Uses User model from Epic 1 (Authentication)
- Admin access uses role-based permissions from Epic 5

### Testing

**Test File Location**: `__tests__/blog/*.test.tsx`, `__tests__/api/blog.test.ts`

**Testing Standards**:
- Test blog listing page renders posts
- Test pagination functionality
- Test blog detail page renders post
- Test Markdown rendering
- Test admin CRUD operations (owner only)
- Test API endpoints
- Mock Prisma client
- Test i18n for both EN and FR

**Testing Frameworks**:
- Jest for test runner
- React Testing Library for component testing
- Mock Prisma client
- Mock react-markdown

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-06 | 1.0 | Initial story creation from Epic 7 | Sarah (PO Agent) |

## Dev Agent Record

### Agent Model Used

_To be filled by dev agent_

### Debug Log References

_To be filled by dev agent_

### Completion Notes

_To be filled by dev agent_

### File List

_To be filled by dev agent_

## QA Results

_To be filled by QA agent_
