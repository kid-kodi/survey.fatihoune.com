# <!-- Powered by BMAD™ Core -->

# Story 7.18: 404 & Error Pages

## Status

Draft

## Story

**As a** user,
**I want** helpful error pages when something goes wrong,
**so that** I can navigate back or understand the issue.

## Acceptance Criteria

1. Custom 404 page created at app/not-found.tsx
2. 404 page includes message: "Page not found" with friendly copy (i18n: `Errors.404_message`)
3. 404 page includes search bar to find content
4. 404 page includes links to: Home, Pricing, Features, Contact
5. 404 page includes CTA: "Get Started" if unauthenticated
6. 500 error page created at app/error.tsx
7. 500 page message: "Something went wrong" with apology and retry button (i18n: `Errors.500_message`)
8. 500 page logs error to monitoring service (Sentry)
9. Error pages match site branding and design
10. Error pages are mobile-responsive
11. All error messages and CTAs fully translated

## Tasks / Subtasks

- [ ] Create 404 Not Found page (AC: 1, 2, 3, 4, 5, 9, 10)
  - [ ] Create `app/not-found.tsx`
  - [ ] Add heading: "Page not found" (i18n: `Errors.404_heading`)
  - [ ] Add friendly message (i18n: `Errors.404_message`)
  - [ ] Add search bar (optional, or link to site search)
  - [ ] Add navigation links: Home (/), Pricing (/pricing), Features (/features), Contact (/contact)
  - [ ] Add "Get Started" CTA for unauthenticated users
  - [ ] Match site branding and design
  - [ ] Ensure mobile-responsive

- [ ] Create 500 Error page (AC: 6, 7, 8, 9, 10)
  - [ ] Create `app/error.tsx`
  - [ ] Add heading: "Something went wrong" (i18n: `Errors.500_heading`)
  - [ ] Add apology message (i18n: `Errors.500_message`)
  - [ ] Add retry button (reset error boundary)
  - [ ] Log error to Sentry or console
  - [ ] Match site branding and design
  - [ ] Ensure mobile-responsive

- [ ] Optional: Create additional error pages
  - [ ] 403 Forbidden page (if needed)
  - [ ] 503 Service Unavailable page (if needed)

- [ ] Set up error monitoring (AC: 8)
  - [ ] Install Sentry SDK (optional but recommended)
  - [ ] Configure Sentry in `app/error.tsx`
  - [ ] Log errors to Sentry with context
  - [ ] Or use console.error for simple logging

- [ ] Add internationalization strings (AC: 11)
  - [ ] Add EN translations to `locales/en.json`: Errors.404_heading, Errors.404_message, Errors.500_heading, Errors.500_message
  - [ ] Add FR translations to `locales/fr.json`

- [ ] Testing and validation
  - [ ] Test 404 page by navigating to non-existent route
  - [ ] Test 500 page by triggering an error (throw new Error in page)
  - [ ] Verify all links work on 404 page
  - [ ] Test retry button on 500 page
  - [ ] Verify error logging to Sentry
  - [ ] Test responsive layout
  - [ ] Test language switching (EN/FR)

## Dev Notes

### Epic Context

This is Story 7.18 in Epic 7: Marketing Website & Landing Pages. This story creates user-friendly error pages to improve user experience when errors occur.

### Tech Stack

- **Framework**: Next.js 16 (App Router)
- **React**: 19
- **TypeScript**: 5.x
- **Styling**: Tailwind CSS 4.x
- **UI Components**: shadcn/ui (Button)
- **Error Monitoring**: Sentry (optional)
- **i18n**: next-intl

### Source Tree

- 404 page: `app/not-found.tsx`
- 500 error page: `app/error.tsx`
- Global error page: `app/global-error.tsx` (optional, for layout errors)
- Translations: `locales/en.json` and `locales/fr.json`

### 404 Not Found Page

**app/not-found.tsx**:
```typescript
import Link from 'next/link'
import { Button } from '@/components/ui/button'
import { useTranslations } from 'next-intl'

export default function NotFound() {
  const t = useTranslations('Errors')

  return (
    <div className="flex flex-col items-center justify-center min-h-screen px-4">
      <h1 className="text-6xl font-bold mb-4">404</h1>
      <h2 className="text-2xl font-semibold mb-2">{t('404_heading')}</h2>
      <p className="text-muted-foreground mb-8 text-center max-w-md">
        {t('404_message')}
      </p>

      <div className="flex flex-wrap gap-4 justify-center mb-8">
        <Button asChild>
          <Link href="/">{t('go_home')}</Link>
        </Button>
        <Button variant="outline" asChild>
          <Link href="/pricing">{t('view_pricing')}</Link>
        </Button>
        <Button variant="outline" asChild>
          <Link href="/features">{t('view_features')}</Link>
        </Button>
        <Button variant="outline" asChild>
          <Link href="/contact">{t('contact_us')}</Link>
        </Button>
      </div>

      {/* Optional: Search bar */}
      {/* <input type="search" placeholder="Search..." className="..." /> */}
    </div>
  )
}
```

### 500 Error Page

**app/error.tsx**:
```typescript
'use client'

import { useEffect } from 'react'
import { Button } from '@/components/ui/button'
import { useTranslations } from 'next-intl'

export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string }
  reset: () => void
}) {
  const t = useTranslations('Errors')

  useEffect(() => {
    // Log error to Sentry or console
    console.error('Error occurred:', error)

    // Optional: Send to Sentry
    // Sentry.captureException(error)
  }, [error])

  return (
    <div className="flex flex-col items-center justify-center min-h-screen px-4">
      <h1 className="text-6xl font-bold mb-4">500</h1>
      <h2 className="text-2xl font-semibold mb-2">{t('500_heading')}</h2>
      <p className="text-muted-foreground mb-8 text-center max-w-md">
        {t('500_message')}
      </p>

      <Button onClick={reset}>{t('try_again')}</Button>
    </div>
  )
}
```

### Global Error Page (Optional)

**app/global-error.tsx**:
For errors in the root layout:
```typescript
'use client'

export default function GlobalError({
  error,
  reset,
}: {
  error: Error & { digest?: string }
  reset: () => void
}) {
  return (
    <html>
      <body>
        <h2>Something went wrong!</h2>
        <button onClick={() => reset()}>Try again</button>
      </body>
    </html>
  )
}
```

### Sample i18n Strings

**locales/en.json**:
```json
{
  "Errors": {
    "404_heading": "Page not found",
    "404_message": "Sorry, we couldn't find the page you're looking for. It might have been moved or deleted.",
    "500_heading": "Something went wrong",
    "500_message": "We're sorry, but something went wrong on our end. We've been notified and are working to fix it.",
    "go_home": "Go Home",
    "view_pricing": "View Pricing",
    "view_features": "View Features",
    "contact_us": "Contact Us",
    "try_again": "Try Again"
  }
}
```

**locales/fr.json**:
```json
{
  "Errors": {
    "404_heading": "Page non trouvée",
    "404_message": "Désolé, nous n'avons pas pu trouver la page que vous recherchez. Elle a peut-être été déplacée ou supprimée.",
    "500_heading": "Une erreur s'est produite",
    "500_message": "Nous sommes désolés, mais une erreur s'est produite de notre côté. Nous avons été informés et travaillons à la résoudre.",
    "go_home": "Accueil",
    "view_pricing": "Voir les tarifs",
    "view_features": "Voir les fonctionnalités",
    "contact_us": "Nous contacter",
    "try_again": "Réessayer"
  }
}
```

### Sentry Integration (Optional)

**Install Sentry**:
```bash
pnpm add @sentry/nextjs
```

**Configure Sentry**:
```typescript
// sentry.client.config.ts
import * as Sentry from '@sentry/nextjs'

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  tracesSampleRate: 1.0,
})
```

**Use in error.tsx**:
```typescript
import * as Sentry from '@sentry/nextjs'

useEffect(() => {
  Sentry.captureException(error)
}, [error])
```

### Design Guidelines

- Match site branding (logo, colors, fonts)
- Use large error codes (404, 500) prominently
- Friendly, apologetic tone
- Clear calls to action
- Mobile-responsive layout
- Consider adding illustration or icon

### Integration Points

- Links to marketing pages (/, /pricing, /features, /contact)
- Error logging to Sentry (optional)
- Uses i18n from Story 7.16

### Testing

**Test File Location**: Manual testing primarily, or `__tests__/error-pages/*.test.tsx`

**Testing Standards**:
- Navigate to non-existent route to test 404
- Throw error in page to test 500
- Verify all links work
- Test retry button resets error boundary
- Test responsive layout
- Test language switching (EN/FR)
- Mock Sentry if testing error logging

**Testing Frameworks**:
- Jest for test runner
- React Testing Library for component testing
- Mock next-intl

**Manual Testing**:
- Navigate to /non-existent-page (404)
- Add `throw new Error('Test')` to a page component (500)
- Test in production build (`pnpm build && pnpm start`)

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-06 | 1.0 | Initial story creation from Epic 7 | Sarah (PO Agent) |

## Dev Agent Record

### Agent Model Used

_To be filled by dev agent_

### Debug Log References

_To be filled by dev agent_

### Completion Notes

_To be filled by dev agent_

### File List

_To be filled by dev agent_

## QA Results

_To be filled by QA agent_
