# <!-- Powered by BMADâ„¢ Core -->

# Story 7.9: Contact Page & Form

## Status

Draft

## Story

**As a** potential user or customer,
**I want** to contact the team with questions or inquiries,
**so that** I can get personalized support or sales assistance.

## Acceptance Criteria

1. Contact page created at /contact with public access
2. Page hero: "Get in Touch" with subheading (i18n: `Contact.hero_heading`, `Contact.hero_subheading`)
3. Contact form includes fields: Name, Email, Subject, Message (all i18n labeled)
4. Subject dropdown options: "General Inquiry", "Sales/Custom Plan", "Support", "Partnership" (all i18n)
5. Form validation: all fields required, email format validated
6. API endpoint created (POST /api/contact) to handle submissions
7. Form submission sends email to support team
8. Auto-reply email sent to user confirming receipt (both EN/FR templates)
9. Success message after submission: "Thanks! We'll get back to you within 24 hours" (i18n: `Contact.success_message`)
10. Contact information displayed: email (support@survey.fatihoune.com), location (optional)
11. Social media links: LinkedIn, Twitter, GitHub (optional)
12. CAPTCHA or rate limiting to prevent spam
13. Mobile-responsive form layout
14. All form labels, options, and messages fully translated

## Tasks / Subtasks

- [ ] Create contact page route (AC: 1)
  - [ ] Create `app/contact/page.tsx`
  - [ ] Ensure public access (no auth required)

- [ ] Create page hero section (AC: 2)
  - [ ] Add hero with heading (i18n: `Contact.hero_heading`)
  - [ ] Add subheading (i18n: `Contact.hero_subheading`)

- [ ] Build contact form component (AC: 3, 4, 5)
  - [ ] Create `components/marketing/contact-form.tsx`
  - [ ] Use react-hook-form for form management
  - [ ] Use Zod for validation schema
  - [ ] Add Name field (i18n: `Contact.name_label`)
  - [ ] Add Email field with email validation (i18n: `Contact.email_label`)
  - [ ] Add Subject dropdown (i18n: `Contact.subject_label`)
  - [ ] Add Message textarea (i18n: `Contact.message_label`)
  - [ ] Mark all fields as required

- [ ] Add Subject dropdown options (AC: 4)
  - [ ] "General Inquiry" (i18n: `Contact.subject_general`)
  - [ ] "Sales/Custom Plan" (i18n: `Contact.subject_sales`)
  - [ ] "Support" (i18n: `Contact.subject_support`)
  - [ ] "Partnership" (i18n: `Contact.subject_partnership`)

- [ ] Create API endpoint (AC: 6, 7, 8)
  - [ ] Create `app/api/contact/route.ts`
  - [ ] Validate form data
  - [ ] Send email to support team using email service (Resend/SendGrid)
  - [ ] Send auto-reply email to user
  - [ ] Return success/error response

- [ ] Email templates (AC: 7, 8)
  - [ ] Create support team notification email template
  - [ ] Create auto-reply email template (EN)
  - [ ] Create auto-reply email template (FR)

- [ ] Add success state (AC: 9)
  - [ ] Show success message after submission
  - [ ] Use i18n key `Contact.success_message`
  - [ ] Clear form after successful submission

- [ ] Add contact information (AC: 10)
  - [ ] Display email: support@survey.fatihoune.com
  - [ ] Add location if applicable (optional)

- [ ] Add social media links (AC: 11, optional)
  - [ ] Add LinkedIn link
  - [ ] Add Twitter/X link
  - [ ] Add GitHub link

- [ ] Add spam protection (AC: 12)
  - [ ] Implement rate limiting on API endpoint
  - [ ] Or add CAPTCHA (Google reCAPTCHA or hCaptcha)

- [ ] Add internationalization strings (AC: 14)
  - [ ] Add EN translations to `locales/en.json`: all Contact.* keys
  - [ ] Add FR translations to `locales/fr.json`

- [ ] Testing and validation
  - [ ] Test form validation (required fields, email format)
  - [ ] Test form submission and success state
  - [ ] Test API endpoint
  - [ ] Test email sending (both support and auto-reply)
  - [ ] Test rate limiting
  - [ ] Test responsive layout
  - [ ] Test language switching (EN/FR)

## Dev Notes

### Epic Context

This is Story 7.9 in Epic 7: Marketing Website & Landing Pages. This story creates a contact page with a functional contact form for user inquiries.

### Tech Stack

- **Framework**: Next.js 16 (App Router)
- **React**: 19
- **TypeScript**: 5.x
- **Styling**: Tailwind CSS 4.x
- **UI Components**: shadcn/ui (New York style)
- **Form**: react-hook-form + Zod
- **Email**: Resend or SendGrid
- **i18n**: next-intl
- **Rate Limiting**: Upstash Redis or Vercel KV

### Source Tree

- Contact page: `app/contact/page.tsx`
- Contact form component: `components/marketing/contact-form.tsx`
- API endpoint: `app/api/contact/route.ts`
- Email templates: `emails/contact-notification.tsx`, `emails/contact-auto-reply-en.tsx`, `emails/contact-auto-reply-fr.tsx`
- Translations: `locales/en.json` and `locales/fr.json`

### Form Implementation

Use react-hook-form + Zod pattern from CLAUDE.md:

```tsx
import { useForm } from "react-hook-form"
import { zodResolver } from "@hookform/resolvers/zod"
import * as z from "zod"
import { Form, FormField, FormItem, FormLabel, FormControl, FormMessage } from "@/components/ui/form"

const contactSchema = z.object({
  name: z.string().min(1, "Name is required"),
  email: z.string().email("Invalid email address"),
  subject: z.string().min(1, "Subject is required"),
  message: z.string().min(10, "Message must be at least 10 characters"),
})
```

### Email Service Integration

Use Resend (recommended) or SendGrid:

**Resend**:
```typescript
import { Resend } from 'resend'

const resend = new Resend(process.env.RESEND_API_KEY)

await resend.emails.send({
  from: 'no-reply@survey.fatihoune.com',
  to: 'support@survey.fatihoune.com',
  subject: `New Contact Form Submission: ${subject}`,
  react: ContactNotificationEmail({ name, email, subject, message }),
})
```

### Rate Limiting

Implement rate limiting to prevent spam:
```typescript
import { Ratelimit } from '@upstash/ratelimit'
import { Redis } from '@upstash/redis'

const ratelimit = new Ratelimit({
  redis: Redis.fromEnv(),
  limiter: Ratelimit.slidingWindow(3, '1 h'), // 3 submissions per hour
})
```

### Auto-Reply Email Templates

Create two auto-reply templates (EN/FR) that:
- Thank the user for contacting
- Confirm receipt of their inquiry
- Set expectation: response within 24 hours
- Provide alternative contact methods

### Integration Points

- Links to `/contact` from About page (Story 7.8)
- Add link in navigation and footer (Story 7.11)
- Email service from Story 7.17 infrastructure

### Testing

**Test File Location**: `__tests__/contact/page.test.tsx`, `__tests__/api/contact.test.ts`

**Testing Standards**:
- Test form validation for all fields
- Test successful form submission
- Test error handling
- Mock API endpoint in component tests
- Test API endpoint with mock email service
- Test rate limiting
- Test i18n for both EN and FR

**Testing Frameworks**:
- Jest for test runner
- React Testing Library for component testing
- Mock react-hook-form
- Mock email service (Resend/SendGrid)
- Mock rate limiting

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-06 | 1.0 | Initial story creation from Epic 7 | Sarah (PO Agent) |

## Dev Agent Record

### Agent Model Used

_To be filled by dev agent_

### Debug Log References

_To be filled by dev agent_

### Completion Notes

_To be filled by dev agent_

### File List

_To be filled by dev agent_

## QA Results

_To be filled by QA agent_
